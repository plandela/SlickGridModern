<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="shortcut icon" type="image/ico" href="favicon.ico" />
    <title>SlickGrid spreadsheet</title>
    <link
      rel="stylesheet"
      href="../dist/styles/css/example-demo.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="../dist/styles/css/slick-alpine-theme.css"
      type="text/css"
    />
    <style>
      .slick-cell.copied {
        background: blue;
        background: rgba(0, 0, 255, 0.2);
        transition: 0.5s background;
      }
      /** override slick-cell to make it look like Excel sheet */
      .slick-container {
        --alpine-header-column-height: 20px;
        --alpine-header-font-weight: 500;
        --alpine-cell-border-width: 0 1px 1px 0;
        --alpine-cell-border-color: #d4d4d4;
      }
    </style>
  </head>
  <body>
    <div style="position: relative">
      <div style="width: 600px">
        <div
          id="myGrid"
          class="slick-container"
          style="width: 100%; height: 500px"
        ></div>
      </div>

      <div class="options-panel">
        <h2>
          <a
            href="/examples/index.html"
            style="text-decoration: none; font-size: 22px"
            >&#x2302;</a
          >
          Demonstrates:
        </h2>
        <ul>
          <li>
            Select a range of cells with a mouse on cells with custom formatter
          </li>
          <li>Use custom formatter to create composite cells in grid</li>
        </ul>
        <h2>View Source:</h2>
        <ul>
          <li>
            <a
              href="https://github.com/6pac/SlickGrid/blob/master/examples/example-spreadsheet-with-formatter.html"
              target="_sourcewindow"
            >
              View the source for this example on Github
            </a>
          </li>
        </ul>

        <h2>Range Selection</h2>
        <span id="selectionRange"></span>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs/Sortable.min.js"></script>
    <script src="sortable-cdn-fallback.js"></script>

    <script src="../dist/browser/slick.core.js"></script>
    <script src="../dist/browser/slick.interactions.js"></script>
    <script src="../dist/browser/slick.grid.js"></script>
    <script src="../dist/browser/slick.formatters.js"></script>
    <script src="../dist/browser/plugins/slick.cellrangedecorator.js"></script>
    <script src="../dist/browser/plugins/slick.cellrangeselector.js"></script>
    <script src="../dist/browser/plugins/slick.cellselectionmodel.js"></script>

    <script>
      var grid;
      var data = [];
      let cellSelectionModel;
      var options = {
        enableCellNavigation: true,
        allowDrag: () => true,
      };

      let CompositeCellFormatter = (_row, _cell, value) => {
        return "<div style='background: gray'>AA</div>";
      };

      var columns = [
        {
          id: "selector",
          name: "",
          field: "num",
          width: 30,
        },
      ];

      for (var i = 0; i < 100; i++) {
        columns.push({
          id: i,
          name:
            i < 26
              ? String.fromCharCode("A".charCodeAt(0) + (i % 26))
              : String.fromCharCode("A".charCodeAt(0) + ((i / 26) | 0) - 1) +
                String.fromCharCode("A".charCodeAt(0) + (i % 26)),
          field: i,
          formatter: CompositeCellFormatter,
          width: 60,
        });
      }

      document.addEventListener("DOMContentLoaded", function () {
        for (var i = 0; i < 100; i++) {
          var d = (data[i] = {});
          d["num"] = i;
          d[0] = 10;
        }

        grid = new Slick.Grid("#myGrid", data, columns, options);

        cellSelectionModel = new Slick.CellSelectionModel();
        grid.setSelectionModel(cellSelectionModel);

        cellSelectionModel.onSelectedRangesChanged.subscribe((e, args) => {
          const targetRange = document.querySelector("#selectionRange");
          targetRange.textContent = "";

          for (let slickRange of args) {
            targetRange.textContent += JSON.stringify(slickRange);
          }
        });
      });
    </script>
  </body>
</html>
